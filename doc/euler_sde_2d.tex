\documentclass{article}
\usepackage[pagebackref,letterpaper=true,colorlinks=true,pdfpagemode=none,urlcolor=blue,linkcolor=blue,citecolor=blue,pdfstartview=FitH]{hyperref}

\usepackage{amsmath,amsfonts, amssymb}
\usepackage{graphicx}
\usepackage{color}


\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\textwidth}{6.0in}
\setlength{\topmargin}{0in}
\setlength{\textheight}{8.5in}


\setlength{\parindent}{0in}
\setlength{\parskip}{5px}

%\input{macrosblog}

%%%%%%%%% For wordpress conversion

\def\more{}

\newif\ifblog
\newif\iftex
\blogfalse
\textrue


\usepackage{ulem}
\def\em{\it}
\def\emph#1{\textit{#1}}

\def\image#1#2#3{\begin{center}\includegraphics[#1pt]{#3}\end{center}}

\let\hrefnosnap=\href

\newenvironment{btabular}[1]{\begin{tabular} {#1}}{\end{tabular}}

\newenvironment{red}{\color{red}}{}
\newenvironment{green}{\color{green}}{}
\newenvironment{blue}{\color{blue}}{}

%%%%%%%%% Typesetting shortcuts

\def\B{\{0,1\}}
\def\xor{\oplus}

\def\P{{\mathbb P}}
\def\E{{\mathbb E}}
\def\var{{\bf Var}}

\def\N{{\mathbb N}}
\def\Z{{\mathbb Z}}
\def\R{{\mathbb R}}
\def\C{{\mathbb C}}
\def\Q{{\mathbb Q}}
\def\eps{{\epsilon}}

\def\bz{{\bf z}}

\def\true{{\tt true}}
\def\false{{\tt false}}

%%%%%%%%% Theorems and proofs

\newtheorem{exercise}{Exercise}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}{Example}
\newtheorem{remark}[theorem]{Remark}
\newenvironment{proof}{\noindent {\sc Proof:}}{$\Box$} %\medskip} 
%%%%%%%%% I added
\newtheorem{assumption}{Assumption}
%%%%%%%%

\begin{document}

\section{Abstract}
You will learn
\begin{itemize}
 \item Euler approximation for the solution of 2-d SDE
 \item We shall adapt Euler scheme for 2-d for Heston
\end{itemize}

\section{Problem}
\subsection{General problem}
We will perform Euler scheme for the general 2-d SDE to be considered is given as
$$d X_{t} = b(X_{t}) dt + \sigma(X_{t}) dW_{t}, X_{0} = x_{0}$$
where $b: \mathbb R^{2} \mapsto \mathbb R^{2}$ is a smooth 
vector field 
on  $\mathbb R^{2}$,
$\sigma: \mathbb R^{2} \mapsto \mathbb R^{2\times 2}$ is a smooth 
matrix-valued function, $W$ is a 2-d standard Brownian motion, 
and $x_{0}$ is the initial 2-d vector. It can be written by system of two 1-d SDEs as the following:
$$
\left\{
\begin{array}
 {ll}
 d X_{1,t} = b_{1,t} dt + \sigma_{11,t}dW_{1,t} + \sigma_{12,t} dW_{2,t}, 
 & X_{1,0} = x_{1,0}\\
 d X_{2,t} = b_{2,t} dt + \sigma_{21,t}dW_{1,t} + \sigma_{22,t} dW_{2,t}, 
 & X_{2,0} = x_{2,0}
\end{array}
\right.
$$
In the above, we assume $W_{1}$ and $W_{2}$ are two independent 1-d Brownian motions.

\subsection{Heston model}
Heston model as a stochastic volatility model belongs to 2-d SDE in the above. However, the domain of the diffusion matrix $\sigma$ is not entire 2-d space. 

In the Heston model, the dynamic involves two processes $(S_{t}, \nu_{t})$.
More precisely, the asset price $S$ follows generalized geometric Brownian motion with random volatility process $\sqrt{\nu_{t}}$, i.e.  
$$d S_{t} = r S_{t} dt + \sqrt{\nu_{t}} S_{t} dW_{1,t},$$
while squared of volatility process $\nu$ follows CIR process
$$ d \nu_{t} = \kappa (\theta - \nu_{t}) dt + \xi \sqrt{\nu_{t}} (\rho dW_{1,t} + 
\bar \rho d W_{2,t})$$
with $\rho^{2} + \bar \rho^{2} = 1.$ Feller condition for its existence of the solution is
$$2\kappa \theta > \xi^{2}.$$

Our goal is to adapt the above Euler scheme to Heston model with the following parameters:
$$ S_{0} = 100, \nu(0) = .04, r = .05, \kappa = 1.2, 
\theta = .04, \xi = .3, \rho = .5.$$
The estimation of Call$(T =1, K = 100)$ is given as 10.3009, see Page 357 of \cite{Gla04}. We will use this for our comparison to our computation.



\section{Analysis}

For the general problem with small $\delta>0$, we write Euler scheme as
$$
\left\{
\begin{array}
 {ll}
 X_{1, t+\delta} \approx X_{1, t} + b_{1}(X_{t}) \delta + \sigma_{11} (X_{t}) W_{1, t, t+\delta} + \sigma_{12}(X_{t}) W_{2, t, t+\delta} \\
 X_{2, t+\delta} \approx X_{2, t} + b_{2}(X_{t}) \delta + \sigma_{21} (X_{t}) W_{1, t, t+\delta} + \sigma_{22}(X_{t}) W_{2, t, t+\delta} 
\end{array}
\right.
$$

In Heston model, the coefficients corresponds to, with $x = (x_{1}, x_{2})$
$$b_{1}(x) = r x_{1}, b_{2}(x) = \kappa (\theta - x_{2}), 
\sigma_{11} (x)  = \sqrt{x_{2}} x_{1}, \sigma_{12}(x) = 0,
\sigma_{21}(x) = \xi \sqrt{x_{2}} \rho, \sigma_{22}(x) = \xi \sqrt{x_{2}} \bar \rho
.$$
However, the above scheme does not directly work out, since $X_{2, t}$ during approximation needs to take non-negative number to have $\sqrt{X_{2,t}}$ makes sense. Instead, we will replace it by $\sqrt{(X_{2,t})^{+}}$. 






\bibliographystyle{plain}
%\bibliographystyle{plainnat}
%\bibliographystyle{apalike}
\bibliography{/Users/songqsh/Dropbox/R/refs}
\end{document}
